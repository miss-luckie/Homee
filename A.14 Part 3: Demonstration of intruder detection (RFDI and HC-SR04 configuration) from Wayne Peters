FUNCTION ultrasonic_loop:
WHILE continue_reading IS TRUE:
â€ƒSEND 10-microsecond trigger pulse to TRIG pin
â€ƒWAIT for echo start and echo end signals
â€ƒCALCULATE duration â† end - start
â€ƒCALCULATE distance â† duration * 17150â€ƒ// convert to cm

â€ƒIF distance IS GREATER THAN 2 AND LESS THAN 10:
â€ƒâ€ƒDISPLAY "ğŸš¨ Intruder Detected!"
â€ƒâ€ƒLOCK lcd_lock
â€ƒâ€ƒCLEAR LCD
â€ƒâ€ƒDISPLAY "Intruder Detected!" on LCD
â€ƒâ€ƒUNLOCK lcd_lock

â€ƒâ€ƒLOG event "Intruder Detected" with placeholder ID

â€ƒâ€ƒSET flash_end_time â† current_time + 5 seconds
â€ƒâ€ƒWHILE current_time < flash_end_time:
â€ƒâ€ƒâ€ƒTURN ON red LED
â€ƒâ€ƒâ€ƒWAIT 0.2 seconds
â€ƒâ€ƒâ€ƒTURN OFF LED
â€ƒâ€ƒâ€ƒWAIT 0.2 seconds

â€ƒâ€ƒLOCK lcd_lock
â€ƒâ€ƒCLEAR LCD
â€ƒâ€ƒUNLOCK lcd_lock

â€ƒWAIT 1 second
